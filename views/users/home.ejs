<%- include ('../layouts/homeHeader.ejs') -%>
<style>
    .prod-name {
    white-space: nowrap; /* Prevent text from wrapping */
    overflow: hidden;    /* Hide overflowed text */
    text-overflow: ellipsis; /* Show an ellipsis (...) for overflowed text */
  } 
</style>
    <!-- ****** Welcome Slides Area Start ****** -->
    <section class="welcome_area">
        <div id="carouselExampleControls" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">
                <!-- Single Slide Start -->
                <% if(banner.length>0) {%>
                    <a href="<%=banner[0].url%>">
                        <div class="carousel-item active height-800 bg-img background-overlay"
                            style="background-image: url(./assets/banner-images/<%=banner[0].image%>);">
                            <div class="container h-100">
                                <div class="row h-100 align-items-center">
                                    <div class="col-12">
                                        <div class="welcome_slide_text">
                                            <h2 data-animation="fadeInUp" data-delay="300ms" data-duration="300ms"
                                                class="carousel-heading border-0">Fashion Trends</h2>
                                            <a href="/shop" class="btn karl-btn" data-animation="fadeInUp" data-delay="300ms"
                                                data-duration="300ms">Shop Now</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </a>
                    <% } %>
                        <!-- Single Slide Start -->
                        <% if(banner.length>1) {%>
                            <a href="<%=banner[1].url%>">
                                <div class="carousel-item height-800 bg-img background-overlay"
                                    style="background-image: url(./assets/banner-images/<%=banner[1].image%>);">
                                    <div class="container h-100">
                                        <div class="row h-100 align-items-center">
                                            <div class="col-12">
                                                <div class="welcome_slide_text">
                                                    <h2 data-animation="fadeInUp" data-delay="300ms"
                                                        data-duration="300ms" class="carousel-heading border-0">Summer Collection
                                                    </h2>
                                                    <a href="/shop" class="btn karl-btn" data-animation="fadeInLeftBig"
                                                        data-delay="300ms" data-duration="300ms">Check Collection</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                            <% } %>
                                <!-- Single Slide Start -->
                                <% if(banner.length>2) {%>
                                    <a href="<%=banner[2].url%>">
                                        <div class="carousel-item height-800 bg-img background-overlay"
                                            style="background-image: url(./assets/banner-images/<%=banner[2].image%>);">
                                            <div class="container h-100">
                                                <div class="row h-100 align-items-center">
                                                    <div class="col-12">
                                                        <div class="welcome_slide_text">
                                                            <h2 data-animation="bounceInDown" data-delay="300ms"
                                                                data-duration="300ms" class="carousel-heading border-0">Men
                                                                Fashion</h2>
                                                            <a href="/shop" class="btn karl-btn"
                                                                data-animation="fadeInRightBig" data-delay="300ms"
                                                                data-duration="300ms">Check Collection</a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </a>
                                    <% } %>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls"
                data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls"
                data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    </section>
    <!-- ****** Welcome Slides Area End ****** -->
    <!-- ****** Top Catagory Area Start ****** -->
    <section class="top_catagory_area">
        <div class="row">
            <!-- Single Catagory 1 -->
            <div class="col-md-6 col-12 p-0">
                <% if(banner.length > 3) { %>
                    <a href="<%= banner[3].url %>">
                        <div class="single_catagory_area bg-img"
                            style="background-image: url('./assets/banner-images/<%= banner[3].image %>'); width: 100%; height:100%;">
                            <div class="catagory-content">
                                <h6>On Sunglasses</h6>
                                <h2>upto 15% off</h2>
                                <a href="/shop" class="btn karl-btn">SHOP NOW</a>
                            </div>
                        </div>
                    </a>
                <% } %>
            </div>
    
            <!-- Single Catagory 2 -->
            <div class="col-md-6 col-12 p-0">
                <% if(banner.length > 4) { %>
                    <a href="<%= banner[4].url %>">
                        <div class="single_catagory_area bg-img"
                            style="background-image: url('./assets/banner-images/<%= banner[4].image %>'); width: 100%; height:100%;">
                            <div class="catagory-content">
                                <h6>in shoes excepting the new collection</h6>
                                <h2>STUNNING SHOES</h2>
                                <a href="#" class="btn karl-btn">SHOP NOW</a>
                            </div>
                        </div>
                    </a>
                <% } %>
            </div>
        </div>
    </section>
    
    <!-- ****** Top Catagory Area End ****** -->
    <!-- ****** New Arrivals Area Start ****** -->
    <section class="new_arrivals_area section_padding_100_0 clearfix">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="section_heading text-center">
                        <h2 class="text-decoration-underline">New Arrivals</h2>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row karl-new-arrivals">
                <% if(prodsData && prodsData.length>0){%>

                    <% for (let i=0; i<4; i++) { %>
                        <!-- Single gallery Item Start -->
                        <div class="col-12 col-md-3 single_gallery_item women wow fadeInUpBig"
                            data-wow-delay="0.2s">
                            <!-- Product Image -->
                            <div class="product-img">
                                <img src="/assets/product-images/<%= prodsData[i].images[0] %>" alt="">
                                <div class="product-quicview">
                                    <a href="/productdetails/<%= prodsData[i]._id %>" data-toggle="modal"
                                        data-target="#quickview">
                                        <i class="bi bi-plus-lg text-light"></i>
                                    </a>
                                </div>
                            </div>
                            <!-- Product Description -->
                            <div class="product-description">
                                <div class="d-flex justify-content-start align-items-center">
                                    <h4 class="product-price text-dark fw-bold">&#8377;<%= prodsData[i].price%> &nbsp;</h4>
                                    <span>
                                        <h5 class="text-secondary"><s> &#8377;<%=prodsData[i].price +
                                                    prodsData[i].discountPrice %></s></h5>
                                    </span>
                                    <br>
                                </div>
                                <p class="discount">
                                    <% const discountPercentage=((prodsData[i].price - prodsData[i].discountPrice) /
                                        prodsData[i].price) * 100; %>
                                        <%= Math.floor(discountPercentage) %>% off
                                </p>
                                <p class="pb-3 prod-name">
                                    <%= prodsData[i].name %>
                                        <!-- Add to Cart -->
                                </p>
                                <% if(locals.user) { %>
                                                        <div class="">
                                                            <!-- Add to Cart button -->
                                                            <% const cartProductIds = cartData.map(item => item.productId._id.toString()); %>
                                                            <% if (cartProductIds.includes(prodsData[i]._id.toString())) { %>
                                                                <form action='/removecartproduct/<%= prodsData[i]._id %>' method="post">
                                                                    <button class="btn btn-outline-dark text-center border-1 w-100" type="submit" style="border-width: 4px;">
                                                                        REMOVE FROM CART <i class="bi bi-bag-check-fill text-danger"></i>
                                                                    </button>                                                                  
                                                                </form>
                                                            <% } else { %>
                                                                    <form action='/productdetails/<%= prodsData[i]._id %>' method="get">
                                                                        <button class="btn btn-outline-dark text-center border-1 w-100" type="submit" style="border-width: 4px;">ADD TO CART <i class="bi bi-cart-plus"></i>
                                                                    </form>
                                                            <% } %>  
                                                            <!-- Wishlist button -->
                                                            <form action="/wishlist/<%= prodsData[i]._id %>" method="post">
                                                                <% if (wishlist.includes(prodsData[i]._id.toString())) { %>
                                                                    <button
                                                                        class="btn btn-outline-dark text-center border-1 w-100 mt-2"
                                                                        type="submit" style="border-width: 4px;">REMOVE FROM WISHLIST
                                                                        <i class="bi bi-heart-fill text-danger"></i>
                                                                    </button>
                                                                    <% } else { %>
                                                                        <button
                                                                            class="btn btn-outline-dark text-center border-1 w-100 mt-2"
                                                                            type="submit" style="border-width: 4px;">ADD TO WISHLIST
                                                                            <i class="bi bi-heart"></i>
                                                                        </button>
                                                                        <% } %>
                                                            </form>
                                                        </div>
                                                        <% } else { %>
                                                            <div class="justify-content-between d-flex column-gap-1">
                                                                <!-- Cart button for guest users -->
                                                                <a href="/login"
                                                                    class="btn btn-outline-dark w-50 text-center"><i
                                                                        class="bi bi-cart-plus"></i></a>
                                                                <!-- Wishlist button for guest users -->
                                                                <a href="/login"
                                                                    class="btn btn-outline-dark w-50 text-center"><i
                                                                        class="bi bi-heart"></i></a>
                                                            </div>
                                                            <% } %>
                            </div>
                        </div>
                        <% } %>
                </div>
                <%}%>
        </div>
    </section>
    <!-- ****** New Arrivals Area End ****** -->
    <!-- ****** Offer Area Start ****** -->
    <% if(banner.length){%>

        <section class="offer_area w-100 col-md-12 height-700 section_padding_100 bg-img"
            style="background-image: url(./assets/banner-images/<%=banner[5].image%>);">
            <div class="container h-100">
                <div class="row h-100 align-items-end justify-content-end">
                    <div class="col-12 col-md-8 col-lg-6">
                        <div class="offer-content-area wow fadeInUp" data-wow-delay="1s">
                            <h2>t-shirt <span class="karl-level">Hot</span></h2>
                            <p>* Free shipping until 10 September 2023</p>
                            <div class="offer-product-price">
                                <h3><span class="regular-price">&#8377;1399</span> &#8377;999</h3>
                            </div>
                            <a href="<%=banner[5].url%>" class="btn karl-btn mt-30">Shop Now</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    <!-- ****** Offer Area End ****** -->
    <%}%>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"
        integrity="sha384-fbbOQedDUMZZ5KreZpsbe1LCZPVmfTnH7ois6mU1QK+m14rQ1l2bGBq41eYeM/fS"
        crossorigin="anonymous"></script>
    <!-- Plugins js -->
    <script src="/static/js/plugins.js"></script>
    <!-- Active js -->
    <script src="/static/js/active.js"></script>
    <%- include ('../layouts/footer.ejs') -%>